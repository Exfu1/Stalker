(function(v,y,o,B,a,M,S,m){"use strict";const{FormSection:R,FormRow:s,FormDivider:w}=M.Forms,b=o.findByStoreName("UserStore"),k=o.findByStoreName("GuildStore"),u=o.findByStoreName("ChannelStore"),C=o.findByStoreName("MessageStore"),P=o.findByStoreName("GuildMemberStore");let p=[];function F(n){const c=k?Object.values(k.getGuilds()||{}):[],e=[];for(const t of c)P?.getMember(t.id,n)&&e.push(t);return e}function N(n,c){var e,t;const d=[];for(const l of c)try{const f=(u?Object.values(((e=u.getChannels)==null?void 0:e.call(u))||((t=u.getMutableGuildChannels)==null?void 0:t.call(u))||{}):[]).filter(function(r){return r.guild_id===l.id&&r.type===0});for(const r of f){const g=C?.getMessages(r.id);if(g!=null&&g._array){const h=g._array.filter(function(i){var A;return((A=i.author)==null?void 0:A.id)===n});for(let i=0;i<Math.min(h.length,3);i++)d.push({id:h[i].id,content:(h[i].content||"").substring(0,50),channel:r.name,guild:l.name})}}}catch{}return d.slice(0,10)}var E={onLoad:function(){try{const n=o.findByProps("UserProfileSection");n!=null&&n.default&&p.push(B.after("default",n,function(c,e){var t,d;const l=(t=c[0])==null?void 0:t.userId;if(!l)return e;const f=b?.getCurrentUser();if(f&&l===f.id)return e;if((d=e?.props)!=null&&d.children&&Array.isArray(e.props.children)){const r=F(l),g=a.React.createElement(R,{key:"stalker-pro",title:"\u{1F50D} Stalker Pro"},[a.React.createElement(s,{key:"recent",label:"Recent Messages",subLabel:"Find their messages across servers",trailing:s.Arrow?a.React.createElement(s.Arrow,null):null,onPress:function(){const h=N(l,r);m.showToast(`Found ${h.length} messages`,S.getAssetIDByName("Check"))}}),a.React.createElement(w,{key:"div"}),a.React.createElement(s,{key:"hidden",label:"Hidden Channels",subLabel:"Channels they can see but you can't",trailing:s.Arrow?a.React.createElement(s.Arrow,null):null,onPress:function(){m.showToast(`Checking ${r.length} servers`,S.getAssetIDByName("Check"))}})]);e.props.children.push(g)}return e})),m.showToast("Stalker Pro loaded!",S.getAssetIDByName("Check")),y.logger.log("Stalker Pro plugin loaded successfully")}catch(n){y.logger.error("Stalker Pro load error:",n)}},onUnload:function(){for(const n of p)n?.();p=[],y.logger.log("Stalker Pro plugin unloaded")}};return v.default=E,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts);
