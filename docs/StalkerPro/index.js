(function(q,Ye,R,e,Je,b,k,Q){"use strict";var qe=Object.defineProperty,Qe=Object.defineProperties,Xe=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,Ze=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable,Se=(t,n,a)=>n in t?qe(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,Ee=(t,n)=>{for(var a in n||(n={}))Ze.call(n,a)&&Se(t,a,n[a]);if(ke)for(var a of ke(n))et.call(n,a)&&Se(t,a,n[a]);return t},ve=(t,n)=>Qe(t,Xe(n)),Ce,me,Ie,Te,we,Fe,Be,De;const{ScrollView:Pe,View:p,Text:o,TouchableOpacity:m,TextInput:$e}=Je.General,ne=((Ce=e.ReactNative)==null?void 0:Ce.BackHandler)||R.findByProps("addEventListener","removeEventListener","exitApp"),A=R.findByStoreName("UserStore"),F=R.findByStoreName("GuildStore"),P=R.findByStoreName("GuildMemberStore"),S=R.findByStoreName("ChannelStore"),N=R.findByStoreName("SelectedGuildStore"),re=R.findByStoreName("GuildChannelStore"),le=R.findByStoreName("GuildRoleStore"),W=R.findByProps("getChannelPermissions","can"),{getChannel:Ae}=R.findByProps("getChannel")||{},ae=((me=R.findByProps("ChannelTypes"))==null?void 0:me.ChannelTypes)||{},$=((Ie=e.ReactNative)==null?void 0:Ie.Clipboard)||R.findByProps("setString","getString"),ie=R.findByProps("getAPIBaseURL","get")||R.findByProps("API_HOST","get");let G=[];const tt=50;function s(t,n){const a=`[${new Date().toLocaleTimeString()}] [${t}] ${n}`;G.unshift(a),G.length>tt&&G.pop(),Ye.logger.log(a)}function oe(){return G}function nt(){G=[]}s("INIT","Starting module discovery...");const ce=R.findByName("UserProfileHeader",!1);(Te=R.findByProps("UserProfileActions"))==null||Te.UserProfileActions;const H=R.findByName("UserProfileSection",!1),se=R.findByName("ProfileBanner",!1),O=R.findByName("ChannelLongPressActionSheet",!1),rt=R.findByName("ChannelLongPress",!1);R.findByName("ChannelContextMenu",!1),R.findByProps("openContextMenu","closeContextMenu");const lt=R.findByProps("ChannelLongPressActionSheet");R.findByProps("openLazy","hideActionSheet");const B=R.findByProps("openLazy","hideActionSheet");R.findByName("ActionSheetRow",!1),R.findByName("ActionSheetTitleHeader",!1),R.findByName("ActionSheetCloseButton",!1),(we=R.findByProps("NavigationContainer"))==null||we.default,R.findByProps("createStackNavigator"),(Fe=R.findByProps("useNavigation"))==null||Fe.useNavigation;const de=R.findByProps("registerCommand","unregisterCommand");if(s("INIT",`UserProfileHeader: ${!!ce}`),s("INIT",`UserProfileSection: ${!!H}`),s("INIT",`ProfileBanner: ${!!se}`),s("INIT",`ChannelLongPress: ${!!O}`),s("INIT",`ChannelLongPress2: ${!!rt}`),s("INIT",`ChannelActionSheet: ${!!lt}`),s("INIT",`ActionSheet: ${!!B}`),s("INIT",`Commands: ${!!de}`),O)try{const t=Object.keys(O);s("KEYS",`ChannelLongPress keys: ${t.join(", ")||"none"}`),typeof O=="function"&&s("KEYS","ChannelLongPress is a function")}catch(t){s("ERROR",`Keys read failed: ${t}`)}if(H)try{const t=Object.keys(H);s("KEYS",`UserProfileSection keys: ${t.join(", ")||"none"}`),typeof H=="function"&&s("KEYS","UserProfileSection is a function")}catch(t){s("ERROR",`Keys read failed: ${t}`)}if(B)try{const t=Object.keys(B);s("KEYS",`ActionSheet keys: ${t.join(", ")||"none"}`)}catch(t){s("ERROR",`Keys read failed: ${t}`)}const Ne=((De=(Be=e.constants)==null?void 0:Be.Permissions)==null?void 0:De.VIEW_CHANNEL)||1024,at={1:"Create Invite",2:"Kick Members",4:"Ban Members",8:"Administrator",16:"Manage Channels",32:"Manage Server",64:"Add Reactions",128:"View Audit Log",256:"Priority Speaker",512:"Stream",1024:"View Channel",2048:"Send Messages",4096:"Send TTS",8192:"Manage Messages",16384:"Embed Links",32768:"Attach Files",65536:"Read History",131072:"Mention Everyone",262144:"Use External Emoji",524288:"View Insights",1048576:"Connect",2097152:"Speak",4194304:"Mute Members",8388608:"Deafen Members",16777216:"Move Members",33554432:"Use VAD",67108864:"Change Nickname",134217728:"Manage Nicknames",268435456:"Manage Roles",536870912:"Manage Webhooks",1073741824:"Manage Emojis"};let ue=!0,_=!1,fe="",X=null,z=[],Z=!1,x={type:null,id:null};const ze=[ae.DM,ae.GROUP_DM,ae.GUILD_CATEGORY];function ye(t,n){if(!(!e.FluxDispatcher||n.length===0))try{e.FluxDispatcher.dispatch({type:"GUILD_MEMBERS_REQUEST",guildIds:[t],userIds:n})}catch{}}function it(t){var n,a;if(!t||(typeof t=="string"&&(t=Ae?.(t)||((n=S?.getChannel)==null?void 0:n.call(S,t))),!t||ze.includes(t.type)))return!1;t.realCheck=!0;const c=!((a=W?.can)!=null&&a.call(W,Ne,t));return delete t.realCheck,c}function xe(t){const n=Number(t),a=[];for(const[c,i]of Object.entries(at))n&Number(c)&&a.push(i);return a}function ot(t,n){var a,c,i;try{const l=(a=F?.getGuild)==null?void 0:a.call(F,n);if((c=l?.roles)!=null&&c[t])return{name:l.roles[t].name,color:l.roles[t].color||0,found:!0}}catch{}try{if(le){const l=(i=le.getRole)==null?void 0:i.call(le,n,t);if(l)return{name:l.name,color:l.color||0,found:!0}}}catch{}return{name:`Role ID: ${t}`,color:5793266,found:!1}}function ct(t,n){var a,c;const i=(a=A?.getUser)==null?void 0:a.call(A,t),l=(c=P?.getMember)==null?void 0:c.call(P,n,t);return i?{name:l?.nick||i.globalName||i.username,isFetched:!0}:{name:`User ID: ${t}`,isFetched:!1}}function V(t,n){const a=[],c=[];try{const i=t.permissionOverwrites||{};for(const[l,u]of Object.entries(i)){if(!u)continue;const E=Number(u.allow||0),v=Number(u.deny||0),f=u.type===0||u.type==="role",g=f?"role":"user";let y="",T=0,M=!1,w=!0;if(f)if(l===n)y="@everyone",T=10070709;else{const I=ot(l,n);y=I.name,T=I.color,M=!I.found}else{c.push(l);const I=ct(l,n);y=I.name,w=I.isFetched,M=!w}a.push({id:l,name:y,type:g,color:T,allowed:xe(E),denied:xe(v),isUnknown:M,isFetched:w})}a.sort(function(l,u){return l.name==="@everyone"?-1:u.name==="@everyone"?1:l.type!==u.type?l.type==="role"?-1:1:l.name.localeCompare(u.name)})}catch{}return{overwrites:a,userIds:c}}function ge(t){switch(t){case 0:return"\u{1F4AC}";case 2:return"\u{1F50A}";case 4:return"\u{1F4C1}";case 5:return"\u{1F4E2}";case 13:return"\u{1F3AD}";case 15:return"\u{1F4CB}";default:return"\u{1F4DD}"}}function st(t){var n,a;const c=new Map;try{const i=(n=S?.getMutableGuildChannelsForGuild)==null?void 0:n.call(S,t);if(i)for(const l of Array.isArray(i)?i:Object.values(i))l!=null&&l.id&&c.set(l.id,l)}catch{}try{const i=(a=S?.getMutableGuildChannels)==null?void 0:a.call(S);if(i)for(const l of Object.values(i))l?.guild_id===t&&l!=null&&l.id&&c.set(l.id,l)}catch{}try{if(re!=null&&re.getChannels){const i=re.getChannels(t);if(i){const l=function(u){if(Array.isArray(u))for(const E of u){const v=E?.channel||E;v!=null&&v.id&&c.set(v.id,v)}};if(Array.isArray(i))l(i);else for(const u of Object.keys(i))Array.isArray(i[u])&&l(i[u])}}}catch{}return Array.from(c.values())}function Le(t){var n,a;const c=[];Z=!0;try{const i=st(t);for(const l of i)!(l!=null&&l.id)||l.type===4||l.type===1||l.type===3||l.type===11||l.type===12||ze.includes(l.type)||it(l)&&c.push({id:l.id,name:l.name||"unknown",type:l.type||0,parentName:l.parent_id&&((a=(n=S?.getChannel)==null?void 0:n.call(S,l.parent_id))==null?void 0:a.name)||"",permissions:V(l,t),guildId:t})}catch(i){s("ERROR",`getHiddenChannels: ${i}`)}finally{Z=!1}return c.sort(function(i,l){return i.name.localeCompare(l.name)})}function dt(t,n,a){var c;const i=(c=P?.getMember)==null?void 0:c.call(P,a,t);if(!i)return!1;const l=i.roles||[];for(const u of n.permissions.overwrites)if(u.type==="user"&&u.id===t&&u.allowed.includes("View Channel")||u.type==="role"&&l.includes(u.id)&&u.allowed.includes("View Channel"))return!0;return!1}function ut(t,n){return Le(n).filter(function(a){return dt(t,a,n)})}function Oe(t){if(!F||!P)return[];try{return Object.values(F.getGuilds()||{}).filter(function(n){return P.getMember(n.id,t)})}catch{return[]}}async function Ue(t,n){var a,c,i;if(!(ie!=null&&ie.get))return[];try{const l=await ie.get({url:`/guilds/${t}/messages/search`,query:{author_id:n,include_nsfw:!0,sort_by:"timestamp",sort_order:"desc"}}),u=((c=(a=F?.getGuild)==null?void 0:a.call(F,t))==null?void 0:c.name)||"Unknown Server";return(((i=l?.body)==null?void 0:i.messages)||[]).map(function(E){var v,f;return{id:E[0].id,content:E[0].content||"[No text]",channelId:E[0].channel_id,channelName:((f=(v=S?.getChannel)==null?void 0:v.call(S,E[0].channel_id))==null?void 0:f.name)||"unknown",guildId:t,guildName:u,timestamp:E[0].timestamp}})}catch{return[]}}function U(t){return $!=null&&$.setString?($.setString(t),fe=t,!0):!1}function ft(t,n){U(t)&&k.showToast(`\u{1F4CB} ${n==="role"?"Role":"User"} ID copied!`,b.getAssetIDByName("Check"))}async function yt(t){var n;const a=(n=A?.getCurrentUser)==null?void 0:n.call(A);if(a&&t===a.id)return;const c=Oe(t);if(c.length===0){k.showToast("\u274C No mutual servers",b.getAssetIDByName("Small"));return}k.showToast("\u{1F50D} Searching...",b.getAssetIDByName("ic_search"));let i=[];for(let E=0;E<Math.min(c.length,8);E++){try{i.push(...await Ue(c[E].id,t))}catch{}E<c.length-1&&await new Promise(function(v){return setTimeout(v,250)})}if(i.sort(function(E,v){return new Date(v.timestamp).getTime()-new Date(E.timestamp).getTime()}),i.length===0){k.showToast("\u{1F4ED} No messages",b.getAssetIDByName("Small"));return}const l=i[0],u=`https://discord.com/channels/${l.guildId}/${l.channelId}/${l.id}`;k.showToast(`\u2705 Found ${i.length}!`,b.getAssetIDByName("Check")),setTimeout(function(){U(u)&&k.showToast("\u{1F4CB} Copied latest!",b.getAssetIDByName("Check"))},1500)}async function gt(){if(!(_||!ue))try{if(!($!=null&&$.getString))return;const t=await $.getString();t&&t!==fe&&/^\d{17,19}$/.test(t.trim())&&(fe=t,k.showToast("\u{1F3AF} ID detected!",b.getAssetIDByName("Check")),setTimeout(function(){return yt(t.trim())},1e3))}catch{}}function ht(t){const n=Date.now()-new Date(t).getTime(),a=Math.floor(n/6e4),c=Math.floor(a/60),i=Math.floor(c/24);return i>0?`${i}d ago`:c>0?`${c}h ago`:`${a}m ago`}function pt(t){var n;try{const a=(n=S?.getChannel)==null?void 0:n.call(S,t);if(!a){k.showToast("\u274C Channel not found",b.getAssetIDByName("Small"));return}const c=a.guild_id,i=V(a,c),l=a.name||"Unknown",u=ge(a.type);s("SHEET",`Showing permissions for ${l}`);const E=function(g){return g?`#${g.toString(16).padStart(6,"0")}`:"#99AAB5"},v=function({ow:g}){return e.React.createElement(m,{key:g.id,style:{backgroundColor:"#2b2d31",marginVertical:4,marginHorizontal:12,padding:10,borderRadius:8,borderLeftWidth:3,borderLeftColor:g.type==="role"?E(g.color):"#43b581"},onPress:function(){U(g.id)&&k.showToast(`\u{1F4CB} ${g.type==="role"?"Role":"User"} ID copied!`,b.getAssetIDByName("Check"))}},[e.React.createElement(p,{key:"h",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(o,{key:"i",style:{fontSize:12,marginRight:6}},g.type==="role"?"\u{1F3F7}\uFE0F":"\u{1F464}"),e.React.createElement(o,{key:"n",style:{color:g.type==="role"?E(g.color):"#43b581",fontSize:13,fontWeight:"bold",flex:1}},g.name),e.React.createElement(o,{key:"c",style:{color:"#949ba4",fontSize:9}},"\u{1F4CB}")]),g.allowed.length>0&&e.React.createElement(p,{key:"a",style:{flexDirection:"row",flexWrap:"wrap",marginTop:4}},g.allowed.slice(0,4).map(function(y,T){return e.React.createElement(o,{key:`a${T}`,style:{color:"#43b581",fontSize:9,marginRight:4}},`\u2705${y}`)})),g.denied.length>0&&e.React.createElement(p,{key:"d",style:{flexDirection:"row",flexWrap:"wrap",marginTop:2}},g.denied.slice(0,4).map(function(y,T){return e.React.createElement(o,{key:`d${T}`,style:{color:"#ed4245",fontSize:9,marginRight:4}},`\u274C${y}`)}))])},f=function(){return e.React.createElement(Pe,{style:{maxHeight:400,backgroundColor:"#1e1f22"}},[e.React.createElement(p,{key:"hdr",style:{padding:16,borderBottomWidth:1,borderBottomColor:"#2b2d31"}},[e.React.createElement(p,{key:"r",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(o,{key:"i",style:{fontSize:24,marginRight:10}},u),e.React.createElement(o,{key:"n",style:{color:"#fff",fontSize:18,fontWeight:"bold"}},l)]),e.React.createElement(o,{key:"s",style:{color:"#b5bac1",fontSize:11,marginTop:4}},`${i.overwrites.length} permission overwrites \u2022 Tap to copy ID`)]),...i.overwrites.map(function(g){return e.React.createElement(v,{key:g.id,ow:g})}),e.React.createElement(m,{key:"cpy",style:{margin:12,padding:12,backgroundColor:"#5865F2",borderRadius:8,alignItems:"center"},onPress:function(){U(t)&&k.showToast("\u{1F4CB} Channel ID copied!",b.getAssetIDByName("Check"))}},e.React.createElement(o,{style:{color:"#fff",fontWeight:"bold"}},"\u{1F4CB} Copy Channel ID")),e.React.createElement(m,{key:"close",style:{margin:12,marginTop:0,padding:12,backgroundColor:"#2b2d31",borderRadius:8,alignItems:"center"},onPress:function(){var g;return(g=B?.hideActionSheet)==null?void 0:g.call(B)}},e.React.createElement(o,{style:{color:"#b5bac1"}},"Close"))])};if(B!=null&&B.openLazy)B.openLazy(Promise.resolve({default:f}),"StalkerPermissions"),s("SHEET","\u2705 Opened via openLazy");else{const g=i.overwrites.map(function(y){return`${y.type==="role"?"\u{1F3F7}\uFE0F":"\u{1F464}"} ${y.name}`}).slice(0,3).join(", ");k.showToast(`\u{1F510} ${l}: ${g}...`,b.getAssetIDByName("Check")),s("SHEET","Fallback: toast only (no openLazy)")}}catch(a){s("ERROR",`showChannelPermissionsSheet failed: ${a}`),k.showToast("\u274C Failed to load permissions",b.getAssetIDByName("Small"))}}function Rt(){var t,n,a;const[c,i]=e.React.useState("hidden"),[l,u]=e.React.useState([]),[E,v]=e.React.useState(!1),[f,g]=e.React.useState(null),[y,T]=e.React.useState(null),[M,w]=e.React.useState("Tap 'Scan' to find hidden channels"),[I,K]=e.React.useState(""),[j,Y]=e.React.useState([]),[L,he]=e.React.useState(null),[vt,Me]=e.React.useState(!1),[je,We]=e.React.useState(""),[Ct,pe]=e.React.useState(!1),[Re,He]=e.React.useState([]),[ee,mt]=e.React.useState(ue),[te,be]=e.React.useState(oe());e.React.useState(0),e.React.useEffect(function(){var r,d;if(x.type==="user"&&x.id)K(x.id),i("user"),x={type:null,id:null};else if(x.type==="channel"&&x.id){const h=(r=N?.getGuildId)==null?void 0:r.call(N);if(h){const C=(d=S?.getChannel)==null?void 0:d.call(S,x.id);if(C){const D={id:C.id,name:C.name,type:C.type,parentName:"",permissions:V(C,h),guildId:h};T(D),i("perms")}}x={type:null,id:null}}},[]),e.React.useEffect(function(){var r,d,h;_=!0;const C=(r=N?.getGuildId)==null?void 0:r.call(N);C&&g((d=F?.getGuild)==null?void 0:d.call(F,C));const D=(h=ne?.addEventListener)==null?void 0:h.call(ne,"hardwareBackPress",function(){return y?(T(null),c==="perms"&&i("hidden"),!0):c!=="hidden"?(i("hidden"),!0):!1});return function(){var Ke;_=!1,(Ke=D?.remove)==null||Ke.call(D)}},[y,c]),e.React.useEffect(function(){if(y&&y.permissions.userIds.length>0){ye(y.guildId,y.permissions.userIds);const r=setTimeout(function(){var d;if(y&&f){const h=(d=S?.getChannel)==null?void 0:d.call(S,y.id);h&&T(ve(Ee({},y),{permissions:V(h,f.id)}))}},1500);return function(){return clearTimeout(r)}}},[y?.id]);const It=function(){var r,d;v(!0),u([]);try{const h=(r=N?.getGuildId)==null?void 0:r.call(N);if(h){g((d=F?.getGuild)==null?void 0:d.call(F,h));const C=Le(h);u(C),w(`Scanned \u2192 ${C.length} hidden`),k.showToast(C.length>0?`\u{1F512} ${C.length} hidden!`:"\u2728 No hidden",b.getAssetIDByName("Check"))}else g(null),w("Open a server first")}catch(h){w(`Error: ${h}`)}finally{v(!1)}},Tt=function(){y&&f&&(ye(f.id,y.permissions.userIds),setTimeout(function(){var r;const d=(r=S?.getChannel)==null?void 0:r.call(S,y.id);d&&(T(ve(Ee({},y),{permissions:V(d,f.id)})),k.showToast("\u{1F504} Refreshed!",b.getAssetIDByName("Check")))},500))},wt=function(){const r=I.trim();if(!r||r.length<17){k.showToast("Enter valid ID",b.getAssetIDByName("Small"));return}if(!f){k.showToast("Open a server first",b.getAssetIDByName("Small"));return}Me(!0),ye(f.id,[r]),setTimeout(function(){var d,h;const C=(d=A?.getUser)==null?void 0:d.call(A,r),D=(h=P?.getMember)==null?void 0:h.call(P,f.id,r);he({user:C,member:D,id:r}),Y(ut(r,f.id)),Me(!1)},500)},Ft=async function(){const r=je.trim();if(!r||r.length<17){k.showToast("Enter valid ID",b.getAssetIDByName("Small"));return}pe(!0),He([]);const d=Oe(r);if(d.length===0){k.showToast("\u274C No mutual servers",b.getAssetIDByName("Small")),pe(!1);return}k.showToast("\u{1F50D} Searching...",b.getAssetIDByName("ic_search"));let h=[];for(let C=0;C<Math.min(d.length,8);C++){try{h.push(...await Ue(d[C].id,r))}catch{}C<d.length-1&&await new Promise(function(D){return setTimeout(D,250)})}h.sort(function(C,D){return new Date(D.timestamp).getTime()-new Date(C.timestamp).getTime()}),He(h),pe(!1),k.showToast(h.length>0?`\u2705 ${h.length} messages!`:"\u{1F4ED} No messages",b.getAssetIDByName("Check"))},Bt=function(r){const d=`https://discord.com/channels/${r.guildId}/${r.channelId}/${r.id}`;U(d)&&k.showToast("\u{1F4CB} Link copied!",b.getAssetIDByName("Check"))},Ge=async function(r){var d;try{const h=await((d=$?.getString)==null?void 0:d.call($));h&&(r(h.trim()),k.showToast("\u{1F4CB} Pasted!",b.getAssetIDByName("Check")))}catch{}},Dt=function(r){ue=r,mt(r),k.showToast(r?"\u2705 Auto-search enabled":"\u274C Auto-search disabled",b.getAssetIDByName("Check"))},_e=function(r){return r?`#${r.toString(16).padStart(6,"0")}`:"#99AAB5"},J=function({id:r,label:d,icon:h}){return e.React.createElement(m,{style:{flex:1,padding:6,backgroundColor:c===r?"#5865F2":"#2b2d31",borderRadius:6,marginHorizontal:1},onPress:function(){i(r),r!=="perms"&&T(null),r==="debug"&&be(oe())}},e.React.createElement(o,{style:{color:"#fff",textAlign:"center",fontSize:9,fontWeight:c===r?"bold":"normal"}},`${h}${d}`))},Ve=function({ch:r,onPress:d}){return e.React.createElement(m,{style:{margin:6,padding:10,backgroundColor:"#2b2d31",borderRadius:10,borderLeftWidth:3,borderLeftColor:"#5865F2"},onPress:d},[e.React.createElement(p,{key:"h",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(o,{key:"i",style:{fontSize:14,marginRight:6}},ge(r.type)),e.React.createElement(p,{key:"n",style:{flex:1}},[e.React.createElement(o,{key:"nm",style:{color:"#fff",fontSize:13,fontWeight:"bold"}},r.name),r.parentName&&e.React.createElement(o,{key:"p",style:{color:"#949ba4",fontSize:10}},`in ${r.parentName}`)]),e.React.createElement(o,{key:"a",style:{color:"#5865F2",fontSize:10}},"\u2192")])])},Pt=function({ow:r}){return e.React.createElement(m,{style:{margin:4,marginHorizontal:6,padding:8,backgroundColor:"#2b2d31",borderRadius:8,borderLeftWidth:3,borderLeftColor:r.type==="role"?_e(r.color):"#43b581"},onPress:function(){return ft(r.id,r.type)}},[e.React.createElement(p,{key:"hdr",style:{flexDirection:"row",alignItems:"center",marginBottom:3}},[e.React.createElement(o,{key:"t",style:{fontSize:11,marginRight:4}},r.type==="role"?"\u{1F3F7}\uFE0F":"\u{1F464}"),e.React.createElement(p,{key:"nw",style:{flex:1}},[e.React.createElement(o,{key:"n",style:{color:r.type==="role"?_e(r.color):"#43b581",fontSize:12,fontWeight:"bold"}},r.name),!r.isFetched&&r.type==="user"&&e.React.createElement(o,{key:"hint",style:{color:"#949ba4",fontSize:9}},"Tap refresh")]),e.React.createElement(p,{key:"b",style:{backgroundColor:r.type==="role"?"#5865F2":"#43b581",paddingHorizontal:5,paddingVertical:2,borderRadius:3}},e.React.createElement(o,{style:{color:"#fff",fontSize:8,fontWeight:"bold"}},r.type==="role"?"ROLE":"USER")),e.React.createElement(o,{key:"copy",style:{color:"#949ba4",fontSize:9,marginLeft:4}},"\u{1F4CB}")]),r.allowed.length>0&&e.React.createElement(p,{key:"a",style:{flexDirection:"row",flexWrap:"wrap",marginTop:2}},r.allowed.map(function(d,h){return e.React.createElement(o,{key:`a${h}`,style:{color:"#43b581",fontSize:9,backgroundColor:"rgba(67,181,129,0.15)",paddingHorizontal:4,paddingVertical:1,borderRadius:3,marginRight:2,marginBottom:2}},`\u2705${d}`)})),r.denied.length>0&&e.React.createElement(p,{key:"d",style:{flexDirection:"row",flexWrap:"wrap",marginTop:2}},r.denied.map(function(d,h){return e.React.createElement(o,{key:`d${h}`,style:{color:"#ed4245",fontSize:9,backgroundColor:"rgba(237,66,69,0.15)",paddingHorizontal:4,paddingVertical:1,borderRadius:3,marginRight:2,marginBottom:2}},`\u274C${d}`)}))])};return e.React.createElement(Pe,{style:{flex:1,backgroundColor:"#1e1f22"}},[e.React.createElement(p,{key:"h",style:{padding:10,backgroundColor:"#2b2d31",marginBottom:6}},[e.React.createElement(o,{key:"t",style:{color:"#fff",fontSize:16,fontWeight:"bold",textAlign:"center"}},"\u{1F50D} Stalker Pro v5.5-dev"),e.React.createElement(o,{key:"s",style:{color:"#b5bac1",fontSize:10,textAlign:"center"}},f?`\u{1F4CD} ${f.name}`:"Open a server")]),e.React.createElement(p,{key:"tabs",style:{flexDirection:"row",padding:4,marginBottom:4}},[e.React.createElement(J,{key:"1",id:"hidden",label:"Hidden",icon:"\u{1F512}"}),e.React.createElement(J,{key:"2",id:"perms",label:"Perms",icon:"\u{1F510}"}),e.React.createElement(J,{key:"3",id:"user",label:"User",icon:"\u{1F464}"}),e.React.createElement(J,{key:"4",id:"search",label:"Msgs",icon:"\u{1F4AC}"}),e.React.createElement(J,{key:"5",id:"debug",label:"Debug",icon:"\u{1F41B}"})]),c==="hidden"&&[e.React.createElement(m,{key:"scan",style:{margin:8,padding:12,backgroundColor:"#5865F2",borderRadius:8,alignItems:"center"},onPress:It},e.React.createElement(o,{style:{color:"#fff",fontWeight:"bold",fontSize:14}},E?"\u23F3 Scanning...":"\u{1F504} Scan Server")),e.React.createElement(o,{key:"dbg",style:{color:"#949ba4",textAlign:"center",fontSize:10,marginBottom:6}},M),...l.map(function(r,d){return e.React.createElement(Ve,{key:`c${d}`,ch:r,onPress:function(){T(r),i("perms")}})}),l.length===0&&!E&&e.React.createElement(p,{key:"empty",style:{padding:30,alignItems:"center"}},[e.React.createElement(o,{key:"e1",style:{fontSize:30}},"\u{1F512}"),e.React.createElement(o,{key:"e2",style:{color:"#b5bac1",fontSize:12,marginTop:6,textAlign:"center"}},"Tap 'Scan Server' to find hidden channels")])],c==="perms"&&[!y&&e.React.createElement(p,{key:"no-sel",style:{padding:30,alignItems:"center"}},[e.React.createElement(o,{key:"t1",style:{fontSize:30}},"\u{1F510}"),e.React.createElement(o,{key:"t2",style:{color:"#fff",fontSize:13,marginTop:6}},"Select a channel")]),y&&[e.React.createElement(p,{key:"ch-hdr",style:{padding:10,backgroundColor:"#2b2d31",margin:6,borderRadius:8}},[e.React.createElement(p,{key:"r",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(o,{key:"i",style:{fontSize:18,marginRight:8}},ge(y.type)),e.React.createElement(o,{key:"n",style:{color:"#fff",fontSize:14,fontWeight:"bold",flex:1}},y.name)])]),e.React.createElement(p,{key:"btns",style:{flexDirection:"row",margin:6,marginTop:0}},[e.React.createElement(m,{key:"ref",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginRight:2,alignItems:"center"},onPress:Tt},e.React.createElement(o,{style:{color:"#fff",fontSize:10}},"\u{1F504} Refresh")),e.React.createElement(m,{key:"cpy",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginLeft:2,alignItems:"center"},onPress:function(){U(y.id)&&k.showToast("\u{1F4CB} Channel ID copied",b.getAssetIDByName("Check"))}},e.React.createElement(o,{style:{color:"#b5bac1",fontSize:9}},"\u{1F4CB} Channel ID"))]),e.React.createElement(o,{key:"hint",style:{color:"#949ba4",fontSize:9,textAlign:"center",marginBottom:4}},"Tap any role/user to copy ID"),...y.permissions.overwrites.map(function(r,d){return e.React.createElement(Pt,{key:`ow-${d}`,ow:r})})]],c==="user"&&[e.React.createElement(p,{key:"input-box",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(o,{key:"lbl",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginBottom:4}},"\u{1F464} User ID Lookup"),e.React.createElement(p,{key:"row",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement($e,{key:"input",style:{flex:1,backgroundColor:"#1e1f22",color:"#fff",padding:8,borderRadius:6,fontSize:12},placeholder:"Enter User ID",placeholderTextColor:"#72767d",value:I,onChangeText:K}),e.React.createElement(m,{key:"paste",style:{marginLeft:4,padding:8,backgroundColor:"#3f4147",borderRadius:6},onPress:function(){return Ge(K)}},e.React.createElement(o,{style:{color:"#fff",fontSize:11}},"\u{1F4CB}"))]),e.React.createElement(m,{key:"btn",style:{marginTop:8,padding:10,backgroundColor:"#5865F2",borderRadius:6,alignItems:"center"},onPress:wt},e.React.createElement(o,{style:{color:"#fff",fontWeight:"bold",fontSize:12}},vt?"\u23F3...":"\u{1F50D} Find Hidden Channels"))]),L&&e.React.createElement(p,{key:"user-info",style:{margin:8,marginTop:0,padding:8,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(o,{key:"name",style:{color:"#fff",fontSize:12,fontWeight:"bold"}},((t=L.member)==null?void 0:t.nick)||((n=L.user)==null?void 0:n.globalName)||((a=L.user)==null?void 0:a.username)||`User ${L.id.slice(-6)}`),e.React.createElement(o,{key:"access",style:{color:"#43b581",fontSize:10,marginTop:2}},`\u2705 Can access ${j.length} hidden channels`)]),...j.map(function(r,d){return e.React.createElement(Ve,{key:`uc${d}`,ch:r,onPress:function(){T(r),i("perms")}})}),L&&j.length===0&&e.React.createElement(o,{key:"no",style:{color:"#949ba4",textAlign:"center",fontSize:11,marginTop:10}},"No hidden channel access")],c==="search"&&[e.React.createElement(p,{key:"auto-box",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(p,{key:"row",style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},[e.React.createElement(p,{key:"txt"},[e.React.createElement(o,{key:"t",style:{color:"#fff",fontSize:11,fontWeight:"bold"}},"\u{1F4AC} Auto-Search"),e.React.createElement(o,{key:"s",style:{color:"#b5bac1",fontSize:9}},"Copy User ID \u2192 auto-copies latest message")]),e.React.createElement(m,{key:"toggle",style:{padding:8,backgroundColor:ee?"#43b581":"#ed4245",borderRadius:6},onPress:function(){return Dt(!ee)}},e.React.createElement(o,{style:{color:"#fff",fontSize:10,fontWeight:"bold"}},ee?"ON":"OFF"))]),e.React.createElement(o,{key:"note",style:{color:"#949ba4",fontSize:9,marginTop:6}},_?"\u23F8\uFE0F Paused while dashboard is open":ee?"\u2705 Active":"\u274C Disabled")]),e.React.createElement(p,{key:"search-box",style:{margin:8,marginTop:0,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(o,{key:"lbl",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginBottom:4}},"\u{1F50D} Manual Search"),e.React.createElement(p,{key:"row",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement($e,{key:"input",style:{flex:1,backgroundColor:"#1e1f22",color:"#fff",padding:8,borderRadius:6,fontSize:12},placeholder:"Enter User ID",placeholderTextColor:"#72767d",value:je,onChangeText:We}),e.React.createElement(m,{key:"paste",style:{marginLeft:4,padding:8,backgroundColor:"#3f4147",borderRadius:6},onPress:function(){return Ge(We)}},e.React.createElement(o,{style:{color:"#fff",fontSize:11}},"\u{1F4CB}"))]),e.React.createElement(m,{key:"btn",style:{marginTop:8,padding:10,backgroundColor:"#5865F2",borderRadius:6,alignItems:"center"},onPress:Ft},e.React.createElement(o,{style:{color:"#fff",fontWeight:"bold",fontSize:12}},Ct?"\u23F3 Searching...":"\u{1F50D} Find Messages"))]),Re.length>0&&e.React.createElement(o,{key:"results-title",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginLeft:8,marginTop:4}},`\u{1F4DD} ${Re.length} Messages:`),...Re.slice(0,25).map(function(r,d){return e.React.createElement(m,{key:`msg${d}`,style:{margin:4,marginHorizontal:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8,borderLeftWidth:3,borderLeftColor:"#5865F2"},onPress:function(){return Bt(r)}},[e.React.createElement(p,{key:"hdr",style:{flexDirection:"row",alignItems:"center",marginBottom:4}},[e.React.createElement(o,{key:"ch",style:{color:"#5865F2",fontSize:11,flex:1}},`#${r.channelName}`),e.React.createElement(o,{key:"time",style:{color:"#949ba4",fontSize:9}},ht(r.timestamp))]),e.React.createElement(o,{key:"content",style:{color:"#dcddde",fontSize:11},numberOfLines:2},r.content),e.React.createElement(o,{key:"server",style:{color:"#72767d",fontSize:9,marginTop:4}},`\u{1F4CD} ${r.guildName}`)])})],c==="debug"&&[e.React.createElement(p,{key:"debug-header",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(o,{key:"t",style:{color:"#fff",fontSize:14,fontWeight:"bold"}},"\u{1F41B} Debug Logs"),e.React.createElement(o,{key:"s",style:{color:"#b5bac1",fontSize:10,marginTop:4}},`${te.length} log entries`),e.React.createElement(p,{key:"btns",style:{flexDirection:"row",marginTop:8}},[e.React.createElement(m,{key:"refresh",style:{flex:1,padding:8,backgroundColor:"#5865F2",borderRadius:6,marginRight:4,alignItems:"center"},onPress:function(){return be(oe())}},e.React.createElement(o,{style:{color:"#fff",fontSize:10}},"\u{1F504} Refresh")),e.React.createElement(m,{key:"clear",style:{flex:1,padding:8,backgroundColor:"#ed4245",borderRadius:6,marginLeft:4,alignItems:"center"},onPress:function(){nt(),be([])}},e.React.createElement(o,{style:{color:"#fff",fontSize:10}},"\u{1F5D1}\uFE0F Clear")),e.React.createElement(m,{key:"copy",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginLeft:4,alignItems:"center"},onPress:function(){U(te.join(`
`))&&k.showToast("\u{1F4CB} Logs copied!",b.getAssetIDByName("Check"))}},e.React.createElement(o,{style:{color:"#fff",fontSize:10}},"\u{1F4CB} Copy"))])]),e.React.createElement(p,{key:"module-status",style:{margin:8,marginTop:0,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(o,{key:"t",style:{color:"#fff",fontSize:12,fontWeight:"bold",marginBottom:6}},"\u{1F4E6} Module Status"),e.React.createElement(o,{key:"m1",style:{color:ce?"#43b581":"#ed4245",fontSize:10}},`UserProfileHeader: ${ce?"\u2705":"\u274C"}`),e.React.createElement(o,{key:"m2",style:{color:O?"#43b581":"#ed4245",fontSize:10}},`ChannelLongPress: ${O?"\u2705":"\u274C"}`),e.React.createElement(o,{key:"m3",style:{color:B?"#43b581":"#ed4245",fontSize:10}},`ActionSheet: ${B?"\u2705":"\u274C"}`),e.React.createElement(o,{key:"m4",style:{color:de?"#43b581":"#ed4245",fontSize:10}},`Commands: ${de?"\u2705":"\u274C"}`),e.React.createElement(o,{key:"m5",style:{color:"#949ba4",fontSize:10,marginTop:4}},`Patches active: ${z.length}`)]),...te.map(function(r,d){return e.React.createElement(o,{key:`log${d}`,style:{color:r.includes("ERROR")?"#ed4245":r.includes("SUCCESS")?"#43b581":"#b5bac1",fontSize:9,paddingHorizontal:8,paddingVertical:2,fontFamily:"monospace"}},r)}),te.length===0&&e.React.createElement(o,{key:"no-logs",style:{color:"#949ba4",textAlign:"center",marginTop:20,fontSize:11}},"No logs yet")]])}const bt=Rt;function kt(t,n){x={type:t,id:n},s("ACTION",`Set context: ${t} = ${n}`),k.showToast("\u{1F50D} Open plugin settings to view!",b.getAssetIDByName("Check"))}const St=function(){if(s("LOAD","=== STALKER PRO v5.5-dev ==="),W!=null&&W.can)try{z.push(Q.after("can",W,function([t,n],a){return n!=null&&n.realCheck?a:Z&&t===Ne?!0:a})),s("PATCH","\u2705 Permissions.can patched")}catch(t){s("ERROR",`Permissions.can patch failed: ${t}`)}if(O)try{z.push(Q.after("default",O,function(t,n){var a,c,i,l,u,E,v;try{const f=t[0];if(f){const w=Object.keys(f);s("STRUCT",`Props keys: ${w.join(", ")}`);const I=((a=f?.channel)==null?void 0:a.id)||f?.channelId||f?.id,K=((c=f?.channel)==null?void 0:c.name)||f?.name||"unknown";s("CHANNEL",`LongPress: ${K} (${I})`);for(const j of w.slice(0,5)){const Y=f[j],L=typeof Y;if(L==="object"&&Y!==null){const he=Object.keys(Y).slice(0,3);s("STRUCT",`  props.${j} = {${he.join(", ")}...}`)}else s("STRUCT",`  props.${j} = ${L}`)}}if(n&&(s("STRUCT",`res type: ${((i=n.type)==null?void 0:i.name)||((l=n.type)==null?void 0:l.displayName)||typeof n.type}`),n.props)){const w=Object.keys(n.props);if(s("STRUCT",`res.props keys: ${w.join(", ")}`),n.props.children){const I=n.props.children;Array.isArray(I)?s("STRUCT",`res.props.children = Array(${I.length})`):I&&typeof I=="object"?s("STRUCT",`res.props.children = ${((u=I.type)==null?void 0:u.name)||((E=I.type)==null?void 0:E.displayName)||"object"}`):s("STRUCT",`res.props.children = ${typeof I}`)}}const g=f?.channelId,y=(v=n?.props)==null?void 0:v.channel,T=y?.name||"this channel";s("INJECT",`Wrapping with button for: ${T} (${g})`);const M=e.React.createElement(m,{key:"stalker-action",style:{flexDirection:"row",alignItems:"center",paddingVertical:14,paddingHorizontal:20,backgroundColor:"#2b2d31",marginHorizontal:12,marginTop:8,marginBottom:12,borderRadius:12,borderWidth:1,borderColor:"#5865F2"},onPress:function(){var w;s("ACTION",`Stalker pressed for ${g}`),(w=B?.hideActionSheet)==null||w.call(B),setTimeout(function(){g&&pt(g)},100)}},[e.React.createElement(o,{key:"icon",style:{fontSize:18,marginRight:12}},"\u{1F510}"),e.React.createElement(p,{key:"txt",style:{flex:1}},[e.React.createElement(o,{key:"t1",style:{color:"#fff",fontSize:15,fontWeight:"bold"}},"Stalker Pro"),e.React.createElement(o,{key:"t2",style:{color:"#b5bac1",fontSize:11}},"View permissions")]),e.React.createElement(o,{key:"arrow",style:{color:"#5865F2",fontSize:14}},"\u2192")]);return e.React.createElement(p,{key:"stalker-wrapper",style:{flex:1}},[n,M])}catch(f){return s("ERROR",`ChannelLongPress inject failed: ${f}`),n}})),s("PATCH","\u2705 ChannelLongPress patched (v5.4 - wrapper)")}catch(t){s("ERROR",`ChannelLongPress patch failed: ${t}`)}if(se)try{z.push(Q.after("default",se,function(t,n){var a;try{const c=t[0],i=((a=c?.user)==null?void 0:a.id)||c?.userId;i&&s("PROFILE",`ProfileBanner rendered: ${i}`)}catch(c){s("ERROR",`ProfileBanner read failed: ${c}`)}return n})),s("PATCH","\u2705 ProfileBanner patched (monitoring)")}catch(t){s("ERROR",`ProfileBanner patch failed: ${t}`)}if(H)try{z.push(Q.after("default",H,function(t,n){var a;try{const c=t[0],i=((a=c?.user)==null?void 0:a.id)||c?.userId;if(i&&(s("PROFILE",`UserProfileSection rendered: ${i}`),n&&n.props&&n.props.children)){const l=e.React.createElement(m,{key:"stalker-section",style:{backgroundColor:"#2b2d31",margin:12,padding:12,borderRadius:8,flexDirection:"row",alignItems:"center"},onPress:function(){s("ACTION",`Stalker pressed for user: ${i}`),kt("user",i)}},[e.React.createElement(o,{key:"icon",style:{fontSize:16,marginRight:8}},"\u{1F50D}"),e.React.createElement(o,{key:"text",style:{color:"#fff",fontSize:14}},"Stalker Pro")]),u=n.props.children;Array.isArray(u)&&(u.push(l),s("INJECT","\u2705 Added section to profile"))}}catch(c){s("ERROR",`UserProfileSection inject failed: ${c}`)}return n})),s("PATCH","\u2705 UserProfileSection patched (with injection)")}catch(t){s("ERROR",`UserProfileSection patch failed: ${t}`)}$!=null&&$.getString&&(X=setInterval(gt,2e3),s("LOAD","\u2705 Clipboard monitor started")),s("LOAD",`Total patches: ${z.length}`),k.showToast("\u{1F50D} Stalker Pro v5.1-dev",b.getAssetIDByName("Check"))},Et=function(){s("UNLOAD","Cleaning up..."),X&&(clearInterval(X),X=null);const t=z.length;for(const n of z)try{n()}catch{}z=[],Z=!1,_=!1,s("UNLOAD",`Removed ${t} patches`)};return q.onLoad=St,q.onUnload=Et,q.settings=bt,q})({},vendetta,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts,vendetta.patcher);
