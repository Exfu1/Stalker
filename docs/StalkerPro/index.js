(function(J,nt,d,e,rt,b,k,j){"use strict";var lt=Object.defineProperty,at=Object.defineProperties,it=Object.getOwnPropertyDescriptors,Ce=Object.getOwnPropertySymbols,ot=Object.prototype.hasOwnProperty,ct=Object.prototype.propertyIsEnumerable,Ie=(t,n,l)=>n in t?lt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,Te=(t,n)=>{for(var l in n||(n={}))ot.call(n,l)&&Ie(t,l,n[l]);if(Ce)for(var l of Ce(n))ct.call(n,l)&&Ie(t,l,n[l]);return t},Ne=(t,n)=>at(t,it(n)),me,Pe,Be,Ae,$e,we,De,Fe,ze,Oe;const{ScrollView:st,View:g,Text:c,TouchableOpacity:I,TextInput:xe}=rt.General,le=((me=e.ReactNative)==null?void 0:me.Modal)||d.findByName("Modal",!1)||((Pe=d.findByProps("Modal"))==null?void 0:Pe.Modal),ae=((Be=e.ReactNative)==null?void 0:Be.BackHandler)||d.findByProps("addEventListener","removeEventListener","exitApp");let Q=null;const F=d.findByStoreName("UserStore"),N=d.findByStoreName("GuildStore"),A=d.findByStoreName("GuildMemberStore"),R=d.findByStoreName("ChannelStore"),z=d.findByStoreName("SelectedGuildStore"),ie=d.findByStoreName("GuildChannelStore"),oe=d.findByStoreName("GuildRoleStore"),W=d.findByProps("getChannelPermissions","can"),{getChannel:Le}=d.findByProps("getChannel")||{},ce=((Ae=d.findByProps("ChannelTypes"))==null?void 0:Ae.ChannelTypes)||{},$=(($e=e.ReactNative)==null?void 0:$e.Clipboard)||d.findByProps("setString","getString"),se=d.findByProps("getAPIBaseURL","get")||d.findByProps("API_HOST","get");let G=[];const dt=50;function o(t,n){const l=`[${new Date().toLocaleTimeString()}] [${t}] ${n}`;G.unshift(l),G.length>dt&&G.pop(),nt.logger.log(l)}function de(){return G}function ut(){G=[]}o("INIT","Starting module discovery...");const ue=d.findByName("UserProfileHeader",!1);(we=d.findByProps("UserProfileActions"))==null||we.UserProfileActions;const H=d.findByName("UserProfileSection",!1),fe=d.findByName("ProfileBanner",!1),L=d.findByName("ChannelLongPressActionSheet",!1),ft=d.findByName("ChannelLongPress",!1);d.findByName("ChannelContextMenu",!1),d.findByProps("openContextMenu","closeContextMenu");const yt=d.findByProps("ChannelLongPressActionSheet");d.findByProps("openLazy","hideActionSheet");const U=d.findByProps("openLazy","hideActionSheet");d.findByName("ActionSheetRow",!1),d.findByName("ActionSheetTitleHeader",!1),d.findByName("ActionSheetCloseButton",!1);const gt=(De=d.findByProps("NavigationContainer"))==null?void 0:De.default;d.findByProps("createStackNavigator");const pt=(Fe=d.findByProps("useNavigation"))==null?void 0:Fe.useNavigation,ye=d.findByProps("registerCommand","unregisterCommand");if(o("INIT",`UserProfileHeader: ${!!ue}`),o("INIT",`UserProfileSection: ${!!H}`),o("INIT",`ProfileBanner: ${!!fe}`),o("INIT",`ChannelLongPress: ${!!L}`),o("INIT",`ChannelLongPress2: ${!!ft}`),o("INIT",`ChannelActionSheet: ${!!yt}`),o("INIT",`ActionSheet: ${!!U}`),o("INIT",`Commands: ${!!ye}`),o("INIT",`NavigationNative: ${!!gt}`),o("INIT",`useNavigation: ${!!pt}`),L)try{const t=Object.keys(L);o("KEYS",`ChannelLongPress keys: ${t.join(", ")||"none"}`),typeof L=="function"&&o("KEYS","ChannelLongPress is a function")}catch(t){o("ERROR",`Keys read failed: ${t}`)}if(H)try{const t=Object.keys(H);o("KEYS",`UserProfileSection keys: ${t.join(", ")||"none"}`),typeof H=="function"&&o("KEYS","UserProfileSection is a function")}catch(t){o("ERROR",`Keys read failed: ${t}`)}if(U)try{const t=Object.keys(U);o("KEYS",`ActionSheet keys: ${t.join(", ")||"none"}`)}catch(t){o("ERROR",`Keys read failed: ${t}`)}const ge=d.findByProps("pushLazy","popLazy")||d.findByProps("push","pop")||d.findByProps("navigate"),pe=d.findByProps("transitionTo","back"),ht=d.findByProps("open","openSection")||d.findByName("SettingsRouter",!1);if(o("INIT",`Navigation: ${!!ge}`),o("INIT",`NavigationRouter: ${!!pe}`),o("INIT",`SettingsRouter: ${!!ht}`),ge)try{const t=Object.keys(ge);o("KEYS",`Navigation keys: ${t.join(", ")||"none"}`)}catch(t){o("ERROR",`Navigation keys failed: ${t}`)}if(pe)try{const t=Object.keys(pe);o("KEYS",`NavigationRouter keys: ${t.join(", ")||"none"}`)}catch(t){o("ERROR",`NavigationRouter keys failed: ${t}`)}const Ue=((Oe=(ze=e.constants)==null?void 0:ze.Permissions)==null?void 0:Oe.VIEW_CHANNEL)||1024,Rt={1:"Create Invite",2:"Kick Members",4:"Ban Members",8:"Administrator",16:"Manage Channels",32:"Manage Server",64:"Add Reactions",128:"View Audit Log",256:"Priority Speaker",512:"Stream",1024:"View Channel",2048:"Send Messages",4096:"Send TTS",8192:"Manage Messages",16384:"Embed Links",32768:"Attach Files",65536:"Read History",131072:"Mention Everyone",262144:"Use External Emoji",524288:"View Insights",1048576:"Connect",2097152:"Speak",4194304:"Mute Members",8388608:"Deafen Members",16777216:"Move Members",33554432:"Use VAD",67108864:"Change Nickname",134217728:"Manage Nicknames",268435456:"Manage Roles",536870912:"Manage Webhooks",1073741824:"Manage Emojis"};let he=!0,V=!1,Re="",X=null,w=[],Z=!1,O={type:null,id:null};const Me=[ce.DM,ce.GROUP_DM,ce.GUILD_CATEGORY];function be(t,n){if(!(!e.FluxDispatcher||n.length===0))try{e.FluxDispatcher.dispatch({type:"GUILD_MEMBERS_REQUEST",guildIds:[t],userIds:n})}catch{}}function bt(t){var n,l;if(!t||(typeof t=="string"&&(t=Le?.(t)||((n=R?.getChannel)==null?void 0:n.call(R,t))),!t||Me.includes(t.type)))return!1;t.realCheck=!0;const s=!((l=W?.can)!=null&&l.call(W,Ue,t));return delete t.realCheck,s}function je(t){const n=Number(t),l=[];for(const[s,i]of Object.entries(Rt))n&Number(s)&&l.push(i);return l}function kt(t,n){var l,s,i;try{const a=(l=N?.getGuild)==null?void 0:l.call(N,n);if((s=a?.roles)!=null&&s[t])return{name:a.roles[t].name,color:a.roles[t].color||0,found:!0}}catch{}try{if(oe){const a=(i=oe.getRole)==null?void 0:i.call(oe,n,t);if(a)return{name:a.name,color:a.color||0,found:!0}}}catch{}return{name:`Role ID: ${t}`,color:5793266,found:!1}}function vt(t,n){var l,s;const i=(l=F?.getUser)==null?void 0:l.call(F,t),a=(s=A?.getMember)==null?void 0:s.call(A,n,t);return i?{name:a?.nick||i.globalName||i.username,isFetched:!0}:{name:`User ID: ${t}`,isFetched:!1}}function ee(t,n){const l=[],s=[];try{const i=t.permissionOverwrites||{};for(const[a,f]of Object.entries(i)){if(!f)continue;const h=Number(f.allow||0),E=Number(f.deny||0),C=f.type===0||f.type==="role",v=C?"role":"user";let p="",m=0,M=!1,x=!0;if(C)if(a===n)p="@everyone",m=10070709;else{const T=kt(a,n);p=T.name,m=T.color,M=!T.found}else{s.push(a);const T=vt(a,n);p=T.name,x=T.isFetched,M=!x}l.push({id:a,name:p,type:v,color:m,allowed:je(h),denied:je(E),isUnknown:M,isFetched:x})}l.sort(function(a,f){return a.name==="@everyone"?-1:f.name==="@everyone"?1:a.type!==f.type?a.type==="role"?-1:1:a.name.localeCompare(f.name)})}catch{}return{overwrites:l,userIds:s}}function We(t){switch(t){case 0:return"\u{1F4AC}";case 2:return"\u{1F50A}";case 4:return"\u{1F4C1}";case 5:return"\u{1F4E2}";case 13:return"\u{1F3AD}";case 15:return"\u{1F4CB}";default:return"\u{1F4DD}"}}function St(t){var n,l;const s=new Map;try{const i=(n=R?.getMutableGuildChannelsForGuild)==null?void 0:n.call(R,t);if(i)for(const a of Array.isArray(i)?i:Object.values(i))a!=null&&a.id&&s.set(a.id,a)}catch{}try{const i=(l=R?.getMutableGuildChannels)==null?void 0:l.call(R);if(i)for(const a of Object.values(i))a?.guild_id===t&&a!=null&&a.id&&s.set(a.id,a)}catch{}try{if(ie!=null&&ie.getChannels){const i=ie.getChannels(t);if(i){const a=function(f){if(Array.isArray(f))for(const h of f){const E=h?.channel||h;E!=null&&E.id&&s.set(E.id,E)}};if(Array.isArray(i))a(i);else for(const f of Object.keys(i))Array.isArray(i[f])&&a(i[f])}}}catch{}return Array.from(s.values())}function He(t){var n,l;const s=[];Z=!0;try{const i=St(t);for(const a of i)!(a!=null&&a.id)||a.type===4||a.type===1||a.type===3||a.type===11||a.type===12||Me.includes(a.type)||bt(a)&&s.push({id:a.id,name:a.name||"unknown",type:a.type||0,parentName:a.parent_id&&((l=(n=R?.getChannel)==null?void 0:n.call(R,a.parent_id))==null?void 0:l.name)||"",permissions:ee(a,t),guildId:t})}catch(i){o("ERROR",`getHiddenChannels: ${i}`)}finally{Z=!1}return s.sort(function(i,a){return i.name.localeCompare(a.name)})}function Et(t,n,l){var s;const i=(s=A?.getMember)==null?void 0:s.call(A,l,t);if(!i)return!1;const a=i.roles||[];for(const f of n.permissions.overwrites)if(f.type==="user"&&f.id===t&&f.allowed.includes("View Channel")||f.type==="role"&&a.includes(f.id)&&f.allowed.includes("View Channel"))return!0;return!1}function Ct(t,n){return He(n).filter(function(l){return Et(t,l,n)})}function Ge(t){if(!N||!A)return[];try{return Object.values(N.getGuilds()||{}).filter(function(n){return A.getMember(n.id,t)})}catch{return[]}}async function Ve(t,n){var l,s,i;if(!(se!=null&&se.get))return[];try{const a=await se.get({url:`/guilds/${t}/messages/search`,query:{author_id:n,include_nsfw:!0,sort_by:"timestamp",sort_order:"desc"}}),f=((s=(l=N?.getGuild)==null?void 0:l.call(N,t))==null?void 0:s.name)||"Unknown Server";return(((i=a?.body)==null?void 0:i.messages)||[]).map(function(h){var E,C;return{id:h[0].id,content:h[0].content||"[No text]",channelId:h[0].channel_id,channelName:((C=(E=R?.getChannel)==null?void 0:E.call(R,h[0].channel_id))==null?void 0:C.name)||"unknown",guildId:t,guildName:f,timestamp:h[0].timestamp}})}catch{return[]}}function _(t){return $!=null&&$.setString?($.setString(t),Re=t,!0):!1}function It(t,n){_(t)&&k.showToast(`\u{1F4CB} ${n==="role"?"Role":"User"} ID copied!`,b.getAssetIDByName("Check"))}async function Tt(t){var n;const l=(n=F?.getCurrentUser)==null?void 0:n.call(F);if(l&&t===l.id)return;const s=Ge(t);if(s.length===0){k.showToast("\u274C No mutual servers",b.getAssetIDByName("Small"));return}k.showToast("\u{1F50D} Searching...",b.getAssetIDByName("ic_search"));let i=[];for(let h=0;h<Math.min(s.length,8);h++){try{i.push(...await Ve(s[h].id,t))}catch{}h<s.length-1&&await new Promise(function(E){return setTimeout(E,250)})}if(i.sort(function(h,E){return new Date(E.timestamp).getTime()-new Date(h.timestamp).getTime()}),i.length===0){k.showToast("\u{1F4ED} No messages",b.getAssetIDByName("Small"));return}const a=i[0],f=`https://discord.com/channels/${a.guildId}/${a.channelId}/${a.id}`;k.showToast(`\u2705 Found ${i.length}!`,b.getAssetIDByName("Check")),setTimeout(function(){_(f)&&k.showToast("\u{1F4CB} Copied latest!",b.getAssetIDByName("Check"))},1500)}async function Nt(){if(!(V||!he))try{if(!($!=null&&$.getString))return;const t=await $.getString();t&&t!==Re&&/^\d{17,19}$/.test(t.trim())&&(Re=t,k.showToast("\u{1F3AF} ID detected!",b.getAssetIDByName("Check")),setTimeout(function(){return Tt(t.trim())},1e3))}catch{}}function mt(t){const n=Date.now()-new Date(t).getTime(),l=Math.floor(n/6e4),s=Math.floor(l/60),i=Math.floor(s/24);return i>0?`${i}d ago`:s>0?`${s}h ago`:`${l}m ago`}function Pt(){o("NAV","Opening Stalker popup dashboard..."),Q?(Q(!0),o("NAV","\u2705 Popup dashboard activated")):(o("NAV","\u274C Popup not ready - fallback to toast"),k.showToast("\u{1F4F1} Go to: Settings \u2192 Plugins \u2192 Stalker Pro",b.getAssetIDByName("Check")))}function _e(){var t,n,l;const[s,i]=e.React.useState("hidden"),[a,f]=e.React.useState([]),[h,E]=e.React.useState(!1),[C,v]=e.React.useState(null),[p,m]=e.React.useState(null),[M,x]=e.React.useState("Tap 'Scan' to find hidden channels"),[T,P]=e.React.useState(""),[K,Y]=e.React.useState([]),[D,te]=e.React.useState(null),[ke,Ye]=e.React.useState(!1),[qe,Je]=e.React.useState(""),[Dt,ve]=e.React.useState(!1),[Se,Qe]=e.React.useState([]),[ne,Ft]=e.React.useState(he),[re,Ee]=e.React.useState(de());e.React.useState(0),e.React.useEffect(function(){var r,u;if(O.type==="user"&&O.id)P(O.id),i("user"),O={type:null,id:null};else if(O.type==="channel"&&O.id){const y=(r=z?.getGuildId)==null?void 0:r.call(z);if(y){const S=(u=R?.getChannel)==null?void 0:u.call(R,O.id);if(S){const B={id:S.id,name:S.name,type:S.type,parentName:"",permissions:ee(S,y),guildId:y};m(B),i("perms")}}O={type:null,id:null}}},[]),e.React.useEffect(function(){var r,u,y;V=!0;const S=(r=z?.getGuildId)==null?void 0:r.call(z);S&&v((u=N?.getGuild)==null?void 0:u.call(N,S));const B=(y=ae?.addEventListener)==null?void 0:y.call(ae,"hardwareBackPress",function(){return p?(m(null),s==="perms"&&i("hidden"),!0):s!=="hidden"?(i("hidden"),!0):!1});return function(){var tt;V=!1,(tt=B?.remove)==null||tt.call(B)}},[p,s]),e.React.useEffect(function(){if(p&&p.permissions.userIds.length>0){be(p.guildId,p.permissions.userIds);const r=setTimeout(function(){var u;if(p&&C){const y=(u=R?.getChannel)==null?void 0:u.call(R,p.id);y&&m(Ne(Te({},p),{permissions:ee(y,C.id)}))}},1500);return function(){return clearTimeout(r)}}},[p?.id]);const zt=function(){var r,u;E(!0),f([]);try{const y=(r=z?.getGuildId)==null?void 0:r.call(z);if(y){v((u=N?.getGuild)==null?void 0:u.call(N,y));const S=He(y);f(S),x(`Scanned \u2192 ${S.length} hidden`),k.showToast(S.length>0?`\u{1F512} ${S.length} hidden!`:"\u2728 No hidden",b.getAssetIDByName("Check"))}else v(null),x("Open a server first")}catch(y){x(`Error: ${y}`)}finally{E(!1)}},Ot=function(){p&&C&&(be(C.id,p.permissions.userIds),setTimeout(function(){var r;const u=(r=R?.getChannel)==null?void 0:r.call(R,p.id);u&&(m(Ne(Te({},p),{permissions:ee(u,C.id)})),k.showToast("\u{1F504} Refreshed!",b.getAssetIDByName("Check")))},500))},xt=function(){const r=T.trim();if(!r||r.length<17){k.showToast("Enter valid ID",b.getAssetIDByName("Small"));return}if(!C){k.showToast("Open a server first",b.getAssetIDByName("Small"));return}Ye(!0),be(C.id,[r]),setTimeout(function(){var u,y;const S=(u=F?.getUser)==null?void 0:u.call(F,r),B=(y=A?.getMember)==null?void 0:y.call(A,C.id,r);te({user:S,member:B,id:r}),Y(Ct(r,C.id)),Ye(!1)},500)},Lt=async function(){const r=qe.trim();if(!r||r.length<17){k.showToast("Enter valid ID",b.getAssetIDByName("Small"));return}ve(!0),Qe([]);const u=Ge(r);if(u.length===0){k.showToast("\u274C No mutual servers",b.getAssetIDByName("Small")),ve(!1);return}k.showToast("\u{1F50D} Searching...",b.getAssetIDByName("ic_search"));let y=[];for(let S=0;S<Math.min(u.length,8);S++){try{y.push(...await Ve(u[S].id,r))}catch{}S<u.length-1&&await new Promise(function(B){return setTimeout(B,250)})}y.sort(function(S,B){return new Date(B.timestamp).getTime()-new Date(S.timestamp).getTime()}),Qe(y),ve(!1),k.showToast(y.length>0?`\u2705 ${y.length} messages!`:"\u{1F4ED} No messages",b.getAssetIDByName("Check"))},Ut=function(r){const u=`https://discord.com/channels/${r.guildId}/${r.channelId}/${r.id}`;_(u)&&k.showToast("\u{1F4CB} Link copied!",b.getAssetIDByName("Check"))},Xe=async function(r){var u;try{const y=await((u=$?.getString)==null?void 0:u.call($));y&&(r(y.trim()),k.showToast("\u{1F4CB} Pasted!",b.getAssetIDByName("Check")))}catch{}},Mt=function(r){he=r,Ft(r),k.showToast(r?"\u2705 Auto-search enabled":"\u274C Auto-search disabled",b.getAssetIDByName("Check"))},Ze=function(r){return r?`#${r.toString(16).padStart(6,"0")}`:"#99AAB5"},q=function({id:r,label:u,icon:y}){return e.React.createElement(I,{style:{flex:1,padding:6,backgroundColor:s===r?"#5865F2":"#2b2d31",borderRadius:6,marginHorizontal:1},onPress:function(){i(r),r!=="perms"&&m(null),r==="debug"&&Ee(de())}},e.React.createElement(c,{style:{color:"#fff",textAlign:"center",fontSize:9,fontWeight:s===r?"bold":"normal"}},`${y}${u}`))},et=function({ch:r,onPress:u}){return e.React.createElement(I,{style:{margin:6,padding:10,backgroundColor:"#2b2d31",borderRadius:10,borderLeftWidth:3,borderLeftColor:"#5865F2"},onPress:u},[e.React.createElement(g,{key:"h",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(c,{key:"i",style:{fontSize:14,marginRight:6}},We(r.type)),e.React.createElement(g,{key:"n",style:{flex:1}},[e.React.createElement(c,{key:"nm",style:{color:"#fff",fontSize:13,fontWeight:"bold"}},r.name),r.parentName&&e.React.createElement(c,{key:"p",style:{color:"#949ba4",fontSize:10}},`in ${r.parentName}`)]),e.React.createElement(c,{key:"a",style:{color:"#5865F2",fontSize:10}},"\u2192")])])},jt=function({ow:r}){return e.React.createElement(I,{style:{margin:4,marginHorizontal:6,padding:8,backgroundColor:"#2b2d31",borderRadius:8,borderLeftWidth:3,borderLeftColor:r.type==="role"?Ze(r.color):"#43b581"},onPress:function(){return It(r.id,r.type)}},[e.React.createElement(g,{key:"hdr",style:{flexDirection:"row",alignItems:"center",marginBottom:3}},[e.React.createElement(c,{key:"t",style:{fontSize:11,marginRight:4}},r.type==="role"?"\u{1F3F7}\uFE0F":"\u{1F464}"),e.React.createElement(g,{key:"nw",style:{flex:1}},[e.React.createElement(c,{key:"n",style:{color:r.type==="role"?Ze(r.color):"#43b581",fontSize:12,fontWeight:"bold"}},r.name),!r.isFetched&&r.type==="user"&&e.React.createElement(c,{key:"hint",style:{color:"#949ba4",fontSize:9}},"Tap refresh")]),e.React.createElement(g,{key:"b",style:{backgroundColor:r.type==="role"?"#5865F2":"#43b581",paddingHorizontal:5,paddingVertical:2,borderRadius:3}},e.React.createElement(c,{style:{color:"#fff",fontSize:8,fontWeight:"bold"}},r.type==="role"?"ROLE":"USER")),e.React.createElement(c,{key:"copy",style:{color:"#949ba4",fontSize:9,marginLeft:4}},"\u{1F4CB}")]),r.allowed.length>0&&e.React.createElement(g,{key:"a",style:{flexDirection:"row",flexWrap:"wrap",marginTop:2}},r.allowed.map(function(u,y){return e.React.createElement(c,{key:`a${y}`,style:{color:"#43b581",fontSize:9,backgroundColor:"rgba(67,181,129,0.15)",paddingHorizontal:4,paddingVertical:1,borderRadius:3,marginRight:2,marginBottom:2}},`\u2705${u}`)})),r.denied.length>0&&e.React.createElement(g,{key:"d",style:{flexDirection:"row",flexWrap:"wrap",marginTop:2}},r.denied.map(function(u,y){return e.React.createElement(c,{key:`d${y}`,style:{color:"#ed4245",fontSize:9,backgroundColor:"rgba(237,66,69,0.15)",paddingHorizontal:4,paddingVertical:1,borderRadius:3,marginRight:2,marginBottom:2}},`\u274C${u}`)}))])};return e.React.createElement(st,{style:{flex:1,backgroundColor:"#1e1f22"}},[e.React.createElement(g,{key:"h",style:{padding:10,backgroundColor:"#2b2d31",marginBottom:6}},[e.React.createElement(c,{key:"t",style:{color:"#fff",fontSize:16,fontWeight:"bold",textAlign:"center"}},"\u{1F50D} Stalker Pro v5.8-dev"),e.React.createElement(c,{key:"s",style:{color:"#b5bac1",fontSize:10,textAlign:"center"}},C?`\u{1F4CD} ${C.name}`:"Open a server")]),e.React.createElement(g,{key:"tabs",style:{flexDirection:"row",padding:4,marginBottom:4}},[e.React.createElement(q,{key:"1",id:"hidden",label:"Hidden",icon:"\u{1F512}"}),e.React.createElement(q,{key:"2",id:"perms",label:"Perms",icon:"\u{1F510}"}),e.React.createElement(q,{key:"3",id:"user",label:"User",icon:"\u{1F464}"}),e.React.createElement(q,{key:"4",id:"search",label:"Msgs",icon:"\u{1F4AC}"}),e.React.createElement(q,{key:"5",id:"debug",label:"Debug",icon:"\u{1F41B}"})]),s==="hidden"&&[e.React.createElement(I,{key:"scan",style:{margin:8,padding:12,backgroundColor:"#5865F2",borderRadius:8,alignItems:"center"},onPress:zt},e.React.createElement(c,{style:{color:"#fff",fontWeight:"bold",fontSize:14}},h?"\u23F3 Scanning...":"\u{1F504} Scan Server")),e.React.createElement(c,{key:"dbg",style:{color:"#949ba4",textAlign:"center",fontSize:10,marginBottom:6}},M),...a.map(function(r,u){return e.React.createElement(et,{key:`c${u}`,ch:r,onPress:function(){m(r),i("perms")}})}),a.length===0&&!h&&e.React.createElement(g,{key:"empty",style:{padding:30,alignItems:"center"}},[e.React.createElement(c,{key:"e1",style:{fontSize:30}},"\u{1F512}"),e.React.createElement(c,{key:"e2",style:{color:"#b5bac1",fontSize:12,marginTop:6,textAlign:"center"}},"Tap 'Scan Server' to find hidden channels")])],s==="perms"&&[!p&&e.React.createElement(g,{key:"no-sel",style:{padding:30,alignItems:"center"}},[e.React.createElement(c,{key:"t1",style:{fontSize:30}},"\u{1F510}"),e.React.createElement(c,{key:"t2",style:{color:"#fff",fontSize:13,marginTop:6}},"Select a channel")]),p&&[e.React.createElement(g,{key:"ch-hdr",style:{padding:10,backgroundColor:"#2b2d31",margin:6,borderRadius:8}},[e.React.createElement(g,{key:"r",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(c,{key:"i",style:{fontSize:18,marginRight:8}},We(p.type)),e.React.createElement(c,{key:"n",style:{color:"#fff",fontSize:14,fontWeight:"bold",flex:1}},p.name)])]),e.React.createElement(g,{key:"btns",style:{flexDirection:"row",margin:6,marginTop:0}},[e.React.createElement(I,{key:"ref",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginRight:2,alignItems:"center"},onPress:Ot},e.React.createElement(c,{style:{color:"#fff",fontSize:10}},"\u{1F504} Refresh")),e.React.createElement(I,{key:"cpy",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginLeft:2,alignItems:"center"},onPress:function(){_(p.id)&&k.showToast("\u{1F4CB} Channel ID copied",b.getAssetIDByName("Check"))}},e.React.createElement(c,{style:{color:"#b5bac1",fontSize:9}},"\u{1F4CB} Channel ID"))]),e.React.createElement(c,{key:"hint",style:{color:"#949ba4",fontSize:9,textAlign:"center",marginBottom:4}},"Tap any role/user to copy ID"),...p.permissions.overwrites.map(function(r,u){return e.React.createElement(jt,{key:`ow-${u}`,ow:r})})]],s==="user"&&[e.React.createElement(g,{key:"input-box",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(c,{key:"lbl",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginBottom:4}},"\u{1F464} User ID Lookup"),e.React.createElement(g,{key:"row",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(xe,{key:"input",style:{flex:1,backgroundColor:"#1e1f22",color:"#fff",padding:8,borderRadius:6,fontSize:12},placeholder:"Enter User ID",placeholderTextColor:"#72767d",value:T,onChangeText:P}),e.React.createElement(I,{key:"paste",style:{marginLeft:4,padding:8,backgroundColor:"#3f4147",borderRadius:6},onPress:function(){return Xe(P)}},e.React.createElement(c,{style:{color:"#fff",fontSize:11}},"\u{1F4CB}"))]),e.React.createElement(I,{key:"btn",style:{marginTop:8,padding:10,backgroundColor:"#5865F2",borderRadius:6,alignItems:"center"},onPress:xt},e.React.createElement(c,{style:{color:"#fff",fontWeight:"bold",fontSize:12}},ke?"\u23F3...":"\u{1F50D} Find Hidden Channels"))]),D&&e.React.createElement(g,{key:"user-info",style:{margin:8,marginTop:0,padding:8,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(c,{key:"name",style:{color:"#fff",fontSize:12,fontWeight:"bold"}},((t=D.member)==null?void 0:t.nick)||((n=D.user)==null?void 0:n.globalName)||((l=D.user)==null?void 0:l.username)||`User ${D.id.slice(-6)}`),e.React.createElement(c,{key:"access",style:{color:"#43b581",fontSize:10,marginTop:2}},`\u2705 Can access ${K.length} hidden channels`)]),...K.map(function(r,u){return e.React.createElement(et,{key:`uc${u}`,ch:r,onPress:function(){m(r),i("perms")}})}),D&&K.length===0&&e.React.createElement(c,{key:"no",style:{color:"#949ba4",textAlign:"center",fontSize:11,marginTop:10}},"No hidden channel access")],s==="search"&&[e.React.createElement(g,{key:"auto-box",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(g,{key:"row",style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},[e.React.createElement(g,{key:"txt"},[e.React.createElement(c,{key:"t",style:{color:"#fff",fontSize:11,fontWeight:"bold"}},"\u{1F4AC} Auto-Search"),e.React.createElement(c,{key:"s",style:{color:"#b5bac1",fontSize:9}},"Copy User ID \u2192 auto-copies latest message")]),e.React.createElement(I,{key:"toggle",style:{padding:8,backgroundColor:ne?"#43b581":"#ed4245",borderRadius:6},onPress:function(){return Mt(!ne)}},e.React.createElement(c,{style:{color:"#fff",fontSize:10,fontWeight:"bold"}},ne?"ON":"OFF"))]),e.React.createElement(c,{key:"note",style:{color:"#949ba4",fontSize:9,marginTop:6}},V?"\u23F8\uFE0F Paused while dashboard is open":ne?"\u2705 Active":"\u274C Disabled")]),e.React.createElement(g,{key:"search-box",style:{margin:8,marginTop:0,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(c,{key:"lbl",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginBottom:4}},"\u{1F50D} Manual Search"),e.React.createElement(g,{key:"row",style:{flexDirection:"row",alignItems:"center"}},[e.React.createElement(xe,{key:"input",style:{flex:1,backgroundColor:"#1e1f22",color:"#fff",padding:8,borderRadius:6,fontSize:12},placeholder:"Enter User ID",placeholderTextColor:"#72767d",value:qe,onChangeText:Je}),e.React.createElement(I,{key:"paste",style:{marginLeft:4,padding:8,backgroundColor:"#3f4147",borderRadius:6},onPress:function(){return Xe(Je)}},e.React.createElement(c,{style:{color:"#fff",fontSize:11}},"\u{1F4CB}"))]),e.React.createElement(I,{key:"btn",style:{marginTop:8,padding:10,backgroundColor:"#5865F2",borderRadius:6,alignItems:"center"},onPress:Lt},e.React.createElement(c,{style:{color:"#fff",fontWeight:"bold",fontSize:12}},Dt?"\u23F3 Searching...":"\u{1F50D} Find Messages"))]),Se.length>0&&e.React.createElement(c,{key:"results-title",style:{color:"#fff",fontSize:11,fontWeight:"bold",marginLeft:8,marginTop:4}},`\u{1F4DD} ${Se.length} Messages:`),...Se.slice(0,25).map(function(r,u){return e.React.createElement(I,{key:`msg${u}`,style:{margin:4,marginHorizontal:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8,borderLeftWidth:3,borderLeftColor:"#5865F2"},onPress:function(){return Ut(r)}},[e.React.createElement(g,{key:"hdr",style:{flexDirection:"row",alignItems:"center",marginBottom:4}},[e.React.createElement(c,{key:"ch",style:{color:"#5865F2",fontSize:11,flex:1}},`#${r.channelName}`),e.React.createElement(c,{key:"time",style:{color:"#949ba4",fontSize:9}},mt(r.timestamp))]),e.React.createElement(c,{key:"content",style:{color:"#dcddde",fontSize:11},numberOfLines:2},r.content),e.React.createElement(c,{key:"server",style:{color:"#72767d",fontSize:9,marginTop:4}},`\u{1F4CD} ${r.guildName}`)])})],s==="debug"&&[e.React.createElement(g,{key:"debug-header",style:{margin:8,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(c,{key:"t",style:{color:"#fff",fontSize:14,fontWeight:"bold"}},"\u{1F41B} Debug Logs"),e.React.createElement(c,{key:"s",style:{color:"#b5bac1",fontSize:10,marginTop:4}},`${re.length} log entries`),e.React.createElement(g,{key:"btns",style:{flexDirection:"row",marginTop:8}},[e.React.createElement(I,{key:"refresh",style:{flex:1,padding:8,backgroundColor:"#5865F2",borderRadius:6,marginRight:4,alignItems:"center"},onPress:function(){return Ee(de())}},e.React.createElement(c,{style:{color:"#fff",fontSize:10}},"\u{1F504} Refresh")),e.React.createElement(I,{key:"clear",style:{flex:1,padding:8,backgroundColor:"#ed4245",borderRadius:6,marginLeft:4,alignItems:"center"},onPress:function(){ut(),Ee([])}},e.React.createElement(c,{style:{color:"#fff",fontSize:10}},"\u{1F5D1}\uFE0F Clear")),e.React.createElement(I,{key:"copy",style:{flex:1,padding:8,backgroundColor:"#3f4147",borderRadius:6,marginLeft:4,alignItems:"center"},onPress:function(){_(re.join(`
`))&&k.showToast("\u{1F4CB} Logs copied!",b.getAssetIDByName("Check"))}},e.React.createElement(c,{style:{color:"#fff",fontSize:10}},"\u{1F4CB} Copy"))])]),e.React.createElement(g,{key:"module-status",style:{margin:8,marginTop:0,padding:10,backgroundColor:"#2b2d31",borderRadius:8}},[e.React.createElement(c,{key:"t",style:{color:"#fff",fontSize:12,fontWeight:"bold",marginBottom:6}},"\u{1F4E6} Module Status"),e.React.createElement(c,{key:"m1",style:{color:ue?"#43b581":"#ed4245",fontSize:10}},`UserProfileHeader: ${ue?"\u2705":"\u274C"}`),e.React.createElement(c,{key:"m2",style:{color:L?"#43b581":"#ed4245",fontSize:10}},`ChannelLongPress: ${L?"\u2705":"\u274C"}`),e.React.createElement(c,{key:"m3",style:{color:U?"#43b581":"#ed4245",fontSize:10}},`ActionSheet: ${U?"\u2705":"\u274C"}`),e.React.createElement(c,{key:"m4",style:{color:ye?"#43b581":"#ed4245",fontSize:10}},`Commands: ${ye?"\u2705":"\u274C"}`),e.React.createElement(c,{key:"m5",style:{color:"#949ba4",fontSize:10,marginTop:4}},`Patches active: ${w.length}`)]),...re.map(function(r,u){return e.React.createElement(c,{key:`log${u}`,style:{color:r.includes("ERROR")?"#ed4245":r.includes("SUCCESS")?"#43b581":"#b5bac1",fontSize:9,paddingHorizontal:8,paddingVertical:2,fontFamily:"monospace"}},r)}),re.length===0&&e.React.createElement(c,{key:"no-logs",style:{color:"#949ba4",textAlign:"center",marginTop:20,fontSize:11}},"No logs yet")]])}function Ke(){const[t,n]=e.React.useState(!1);return e.React.useEffect(function(){return Q=n,o("POPUP","Popup dashboard registered"),function(){Q=null}},[]),le?t?e.React.createElement(le,{visible:!0,animationType:"slide",presentationStyle:"fullScreen",onRequestClose:function(){return n(!1)}},e.React.createElement(g,{style:{flex:1,backgroundColor:"#1e1f22"}},[e.React.createElement(g,{key:"header",style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:12,backgroundColor:"#2b2d31",borderBottomWidth:1,borderBottomColor:"#1e1f22"}},[e.React.createElement(c,{key:"title",style:{color:"#fff",fontSize:16,fontWeight:"bold"}},"\u{1F50D} Stalker Pro"),e.React.createElement(I,{key:"close",style:{padding:8,backgroundColor:"#ed4245",borderRadius:6},onPress:function(){return n(!1)}},e.React.createElement(c,{style:{color:"#fff",fontWeight:"bold"}},"\u2715 Close"))]),e.React.createElement(_e,{key:"content"})])):null:(o("POPUP","Modal not available"),null)}const Bt=_e;function At(t,n){O={type:t,id:n},o("ACTION",`Set context: ${t} = ${n}`),k.showToast("\u{1F50D} Open plugin settings to view!",b.getAssetIDByName("Check"))}const $t=function(){o("LOAD","=== STALKER PRO v5.8-dev ==="),o("INIT",`Modal available: ${!!le}`);const t=d.findByName("App",!1)||d.findByName("AppContainer",!1)||d.findByName("Navigator",!1);if(t)try{w.push(j.after("default",t,function(n,l){return l&&e.React.createElement(g,{style:{flex:1}},[l,e.React.createElement(Ke,{key:"stalker-popup"})])})),o("PATCH","\u2705 App container patched for popup")}catch(n){o("ERROR",`App container patch failed: ${n}`)}else{o("INIT","App container not found, trying alternative...");const n=d.findByName("Chat",!1)||d.findByName("ChatContainer",!1);if(n)try{w.push(j.after("default",n,function(l,s){return s&&e.React.createElement(g,{style:{flex:1}},[s,e.React.createElement(Ke,{key:"stalker-popup"})])})),o("PATCH","\u2705 Chat container patched for popup")}catch(l){o("ERROR",`Chat container patch failed: ${l}`)}}if(W!=null&&W.can)try{w.push(j.after("can",W,function([n,l],s){return l!=null&&l.realCheck?s:Z&&n===Ue?!0:s})),o("PATCH","\u2705 Permissions.can patched")}catch(n){o("ERROR",`Permissions.can patch failed: ${n}`)}if(L)try{w.push(j.after("default",L,function(n,l){var s,i,a,f,h,E,C;try{const v=n[0];if(v){const T=Object.keys(v);o("STRUCT",`Props keys: ${T.join(", ")}`);const P=((s=v?.channel)==null?void 0:s.id)||v?.channelId||v?.id,K=((i=v?.channel)==null?void 0:i.name)||v?.name||"unknown";o("CHANNEL",`LongPress: ${K} (${P})`);for(const Y of T.slice(0,5)){const D=v[Y],te=typeof D;if(te==="object"&&D!==null){const ke=Object.keys(D).slice(0,3);o("STRUCT",`  props.${Y} = {${ke.join(", ")}...}`)}else o("STRUCT",`  props.${Y} = ${te}`)}}if(l&&(o("STRUCT",`res type: ${((a=l.type)==null?void 0:a.name)||((f=l.type)==null?void 0:f.displayName)||typeof l.type}`),l.props)){const T=Object.keys(l.props);if(o("STRUCT",`res.props keys: ${T.join(", ")}`),l.props.children){const P=l.props.children;Array.isArray(P)?o("STRUCT",`res.props.children = Array(${P.length})`):P&&typeof P=="object"?o("STRUCT",`res.props.children = ${((h=P.type)==null?void 0:h.name)||((E=P.type)==null?void 0:E.displayName)||"object"}`):o("STRUCT",`res.props.children = ${typeof P}`)}}const p=v?.channelId,m=(C=l?.props)==null?void 0:C.channel,M=m?.name||"this channel";o("INJECT",`Wrapping with button for: ${M} (${p})`);const x=e.React.createElement(I,{key:"stalker-action",style:{flexDirection:"row",alignItems:"center",paddingVertical:14,paddingHorizontal:20,backgroundColor:"#2b2d31",marginHorizontal:12,marginTop:8,marginBottom:12,borderRadius:12,borderWidth:1,borderColor:"#5865F2"},onPress:function(){var T;o("ACTION","Stalker button pressed"),(T=U?.hideActionSheet)==null||T.call(U),setTimeout(function(){Pt()},100)}},[e.React.createElement(c,{key:"icon",style:{fontSize:18,marginRight:12}},"\u{1F50D}"),e.React.createElement(g,{key:"txt",style:{flex:1}},[e.React.createElement(c,{key:"t1",style:{color:"#fff",fontSize:15,fontWeight:"bold"}},"Stalker Pro"),e.React.createElement(c,{key:"t2",style:{color:"#b5bac1",fontSize:11}},"Open Dashboard")]),e.React.createElement(c,{key:"arrow",style:{color:"#5865F2",fontSize:14}},"\u2192")]);return e.React.createElement(g,{key:"stalker-wrapper",style:{flex:1}},[l,x])}catch(v){return o("ERROR",`ChannelLongPress inject failed: ${v}`),l}})),o("PATCH","\u2705 ChannelLongPress patched (v5.4 - wrapper)")}catch(n){o("ERROR",`ChannelLongPress patch failed: ${n}`)}if(fe)try{w.push(j.after("default",fe,function(n,l){var s;try{const i=n[0],a=((s=i?.user)==null?void 0:s.id)||i?.userId;a&&o("PROFILE",`ProfileBanner rendered: ${a}`)}catch(i){o("ERROR",`ProfileBanner read failed: ${i}`)}return l})),o("PATCH","\u2705 ProfileBanner patched (monitoring)")}catch(n){o("ERROR",`ProfileBanner patch failed: ${n}`)}if(H)try{w.push(j.after("default",H,function(n,l){var s;try{const i=n[0],a=((s=i?.user)==null?void 0:s.id)||i?.userId;if(a&&(o("PROFILE",`UserProfileSection rendered: ${a}`),l&&l.props&&l.props.children)){const f=e.React.createElement(I,{key:"stalker-section",style:{backgroundColor:"#2b2d31",margin:12,padding:12,borderRadius:8,flexDirection:"row",alignItems:"center"},onPress:function(){o("ACTION",`Stalker pressed for user: ${a}`),At("user",a)}},[e.React.createElement(c,{key:"icon",style:{fontSize:16,marginRight:8}},"\u{1F50D}"),e.React.createElement(c,{key:"text",style:{color:"#fff",fontSize:14}},"Stalker Pro")]),h=l.props.children;Array.isArray(h)&&(h.push(f),o("INJECT","\u2705 Added section to profile"))}}catch(i){o("ERROR",`UserProfileSection inject failed: ${i}`)}return l})),o("PATCH","\u2705 UserProfileSection patched (with injection)")}catch(n){o("ERROR",`UserProfileSection patch failed: ${n}`)}$!=null&&$.getString&&(X=setInterval(Nt,2e3),o("LOAD","\u2705 Clipboard monitor started")),o("LOAD",`Total patches: ${w.length}`),k.showToast("\u{1F50D} Stalker Pro v5.1-dev",b.getAssetIDByName("Check"))},wt=function(){o("UNLOAD","Cleaning up..."),X&&(clearInterval(X),X=null);const t=w.length;for(const n of w)try{n()}catch{}w=[],Z=!1,V=!1,o("UNLOAD",`Removed ${t} patches`)};return J.onLoad=$t,J.onUnload=wt,J.settings=Bt,J})({},vendetta,vendetta.metro,vendetta.metro.common,vendetta.ui.components,vendetta.ui.assets,vendetta.ui.toasts,vendetta.patcher);
